% \section*{Definições importantes} 
% \begin{equation*} 
% \renewcommand{\arraystretch}{2.5}
% \begin{aligned}
% f(x)& = \text{polinomio em função do vetor }x  \\ \\
% \nabla f(x) &= \left[
% \begin{array}{c}
% \cfrac{\partial f}{\partial x_1}\\
% \cfrac{\partial f}{\partial x_2}\\
% \vdots\\
% \cfrac{\partial f}{\partial x_n}\\
% \end{array}
% \right]\\ \\
% \nabla^2 f(x) &= \left[
% \begin{array}{cccc}
% \cfrac{\partial^2 f}{\partial x_1 \partial x_1} 
% & \cfrac{\partial^2 f}{\partial x_1 \partial x_2} & \cdots
% & \cfrac{\partial^2 f}{\partial x_1 \partial x_n}\\
% \cfrac{\partial^2 f}{\partial x_2 \partial x_1} 
% & \cfrac{\partial^2 f}{\partial x_2 \partial x_2} & \cdots
% & \cfrac{\partial^2 f}{\partial x_2 \partial x_n}\\
% \vdots & \vdots & \ddots
% & \vdots\\
% \cfrac{\partial^2 f}{\partial x_n \partial x_1} 
% & \cfrac{\partial^2 f}{\partial x_n \partial x_2} & \cdots
% & \cfrac{\partial^2 f}{\partial x_n \partial x_n}\\
% \end{array}
% \right]
% \end{aligned}
% \end{equation*}
% \clearpage
% 
\section {Convexidade}
\boxexercise{Convexidade}{
Analisar a convexidade das seguintes funções objetivo:
\begin{align}
f_1 (x) &= 2x_1 + 3x_2 +6 \label{eq:1f1}\\ 
f_2 (x) &= x_1^3 \label{eq:1f2}\\
f_3 (x) &= x_1^2 + x_1 x_2 + x_2 + 4 \label{eq:1f3}
\end{align}
}

\subsection*{\autoref{eq:1f1}}
\begin{equation}
f_1 (x) = 2x_1 + 3x_2 +6 \tag{\ref{eq:1f1}}
\end{equation}
Para a \autoref{eq:1f1} temos que o gradiente de $f_1(x)$ é dado por:
\begin{equation}
\nabla f_1(x) = \left[
\begin{array}{c}
2\\
3
\end{array}
\right]
\end{equation}
e para a hessiana temos:
\begin{equation}
\nabla^2 f_1(x) = \left[
\begin{array}{cc}
0& 0\\
0& 0
\end{array}
\right]
\end{equation}

Calculando os autovalores da matriz $\nabla^2 f_1(x)$ temos para $\forall x$:
\begin{itemize}
  \item $\lambda_1 = 0$
  \item $\lambda_2 = 0$
\end{itemize}
portanto temos uma função convexa, neste caso um plano, dado que a função é
linear.


\subsection*{\autoref{eq:1f2}}
\begin{equation}
f_2 (x) = x_1^3 \tag{\ref{eq:1f2}}
\end{equation}
Para a Equação \autoref{eq:1f2} temos que o gradiente de $f_2(x)$ é dado por:
\begin{equation}
\nabla f_2(x) = \left[
\begin{array}{c}
3x_1^2
\end{array}
\right]
\end{equation}
e para a hessiana temos:
\begin{equation}
\nabla^2 f_2(x) = \left[
\begin{array}{c}
6x_1
\end{array}
\right]
\end{equation}

Calculando os autovalores da matriz $\nabla^2 f_2(x)$ temos:
\begin{itemize}
  \item $\lambda_1 = \left\{
\begin{array}{ccc}
\geq 0& \rm{se}& x_1 \geq 0\\
\leq 0& \rm{se}& x_1 \leq 0
\end{array}
\right.$
\end{itemize}
portanto teriamos uma função convexa para valores positivos de $x_1$ e não
convexa para valores de $x_1$ menores que $0$. Porém, se observarmos a
\autoref{fig:1f2}-(a), observamos que, em todo o domínio da função, não é
convexa.
\begin{figure}[h]
\centering
\def\FunctionF(#1){(#1)^3}
\def\FunctionFd(#1){3*(#1)^2}
\def\FunctionFdd(#1){6*(#1)}
\subfloat[$f_1(x)$]{
\begin{tikzpicture}[scale=0.8]
\begin{axis}[
        axis y line=center,
        axis x line=middle, 
        axis on top=true,
    ]
    \addplot [domain=-2:2, samples=51, mark=none, ultra thick, blue] {\FunctionF(x)};
    \node [right, blue] at (axis cs: 0.5,4.5) {$f_2(x)$};
\end{axis}
\end{tikzpicture}}
\hfill
\subfloat[$\nabla f_1(x)$]{
\begin{tikzpicture}[scale=0.8]
\begin{axis}[
        axis y line=center,
        axis x line=middle, 
        axis on top=true,
    ]
    \addplot [domain=-2:2, samples=51, mark=none, ultra thick, orange]
    {\FunctionFd(x)};
	\addplot [domain=-2:2, samples=51, mark=none, ultra thick, red]
	{\FunctionFdd(x)};
\node [right, orange] at (axis cs: 0.5,-5) {$\nabla f_2(x)$};
\node [right, red] at (axis cs: 0.5,-7) {$\nabla^2 f_2(x)$};
\end{axis}
\end{tikzpicture}}
\caption{$f_2(x) = x_1^3$.}
\label{fig:1f2}
\end{figure}

\subsection*{\autoref{eq:1f3}}
\begin{equation}
f_3 (x) = x_1^2 + x_1 x_2 + x_2 + 4  \tag{\ref{eq:1f3}}
\end{equation}
Para a Equação \autoref{eq:1f3} temos que o gradiente de $f_3(x)$ é dado por:
\begin{equation}
\nabla f_3(x) = \left[
\begin{array}{c}
2x_1 + x_2 \\
x_1 + 2
\end{array}
\right] 
\end{equation}
e para a hessiana temos:
\begin{equation}
\nabla^2 f_3(x) = \left[
\begin{array}{cc}
2 & 1\\
1 & 0
\end{array}
\right]
\end{equation}

Calculando os autovalores da matriz $\nabla^2 f_3(x)$ temos para $\forall x$:
\begin{itemize}
  \item $\lambda_1 = 1 + \sqrt{2} = 2.41$
  \item $\lambda_2 = 1 - \sqrt{2} = -0.41$
\end{itemize}

Sendo esta matriz não definida, não é uma função convexa. Pela \autoref{fig:1f3}
também podemos observar que se trata de uma função do tipo cela.
\begin{figure} [h]
\centering
\begin{tikzpicture}
    \begin{axis}[
        , xlabel = $x_1$
        , ylabel = $x_2$
        , domain = -20:20
        , y domain = -20:20
        , enlargelimits
        , view = {0}{90}
        ]

       \addplot3[samples=100, contour gnuplot={levels={400, 200, 100, 25, 4,
       -25, -50}}, thick] {x^2 + x*y + y + 4};
    \end{axis}
\end{tikzpicture}
\caption{$f_3 (x) = x_1^2 + x_1 x_2 + x_2 + 4$}
\label{fig:1f3}
\end{figure}

\clearpage
\section {Pontos de Mínimo e Máximo}
\boxexercise{Pontos de Mínimo e Máximo}{
Analisar pontos de máximo e mínimo das
seguintes funções:
\begin{align}
f_1 (x) &= |x| \label{eq:2f1}\\ 
f_2 (x) &= -x_1^4 + x_1^3 +20 \label{eq:2f2}\\
f_3 (x) &= x_1^2 + 2x_1 + 3x_2^2 + 6x_2 + 2 \label{eq:2f3}
\end{align}
}

\subsection*{\autoref{eq:2f1}}
\begin{equation}
f_1 (x) = |x| \tag{\ref{eq:2f1}} 
\end{equation}
Para a \autoref{eq:2f1} temos que o gradiente de $f_1(x)$ é dado por:
\begin{equation}
\nabla f_1(x) = \left[
\begin{array}{cc}
1 &\quad \text{se } x> 0\\
-1 &\quad \text{se } x < 0
\end{array}
\right]
\end{equation}

Apesar de $f_1(x)$ não ser possuir gradiente contínuo, podemos verificar que
aplicando em $x_1 = 0$ temos $f_1(x) = 0$ e para $\forall$ $x$, $f_1(x) \geq
0$, como podemos observar na \autoref{fig:2f1}-(a):
\begin{figure}[h]
\centering
\def\FunctionF(#1){abs(#1)}
\def\FunctionFd(#1){1}
\def\FunctionFdd(#1){-1}
\subfloat[$f_1(x)$]{
\begin{tikzpicture}[scale=0.8]
\begin{axis}[
        axis y line=center,
        axis x line=middle, 
        axis on top=true,
        xmin=-5,
        xmax=5,
        ymin=0,
        ymax=5,
    ]
    \addplot [domain=-5:5, samples=51, mark=none, ultra thick, blue] {\FunctionF(x)};
    \node [right, blue] at (axis cs: 0.5,4.5) {$f_1(x)$};
\end{axis}
\end{tikzpicture}}
\hfill
\subfloat[$\nabla f_1(x)$]{
\begin{tikzpicture}[scale=0.8]
\begin{axis}[
        axis y line=center,
        axis x line=middle, 
        axis on top=true,
        xmin=-5,
        xmax=5,
        ymin=-1.2,
        ymax=1.2,
    ]
    \addplot [domain=0:5, samples=51, mark=none, ultra thick, orange]
    {\FunctionFd(x)};
	\addplot [domain=-5:0, samples=51, mark=none, ultra thick, orange]
	{\FunctionFdd(x)}; 
\node [right, orange] at (axis cs: 0.5,0.5) {$\nabla f_1(x)$};
\end{axis}
\end{tikzpicture}}
\caption{$f_1(x) = |x|$.}
\label{fig:2f1}
\end{figure}

Portanto podemos concluir que temos um ponto de mínimo, apesar de não ser
possível o calculo da hessiana de $f_1(x)$.

\subsection*{\autoref{eq:2f2}}
\begin{equation}
f_2 (x) = -x_1^4 + x_1^3 +20 \tag{\ref{eq:2f2}} 
\end{equation}
Para a Equação \autoref{eq:2f2} temos que o gradiente de $f_2(x)$ é dado por:
\begin{equation}
\nabla f_2(x) = \left[
\begin{array}{c}
-4x_1^3 + 3x_1^2
\end{array}
\right]
\end{equation}
Para um ponto de mínimo ou máximo devemos obter $\nabla f_2(x) = 0$, o que
ocorre quando:
\begin{itemize}
  \item $x_1 = 0$
  \item $x_1 = \cfrac{3}{4}$
\end{itemize}
portanto devemos analizar o valor da hessiana nestes dois pontos, como é
possível observar na \autoref{fig:2f2}.

\begin{figure}[h]
\centering
\def\FunctionF(#1){-(#1)^4 + (#1)^3 +20}
\def\FunctionFd(#1){-4*(#1)^3 + 3*(#1)^2}
\def\FunctionFdd(#1){-12*(#1)^2 + 6*(#1)}

\subfloat[$f_2(x)$]
{\begin{tikzpicture}[scale=0.8]
\begin{axis}[
        axis y line=center,
        axis x line=middle, 
        axis on top=true,
        xmin=-1,
        xmax=1.5,
        ymin=19,
        ymax=21,
    ]
    \addplot [domain=-2:2.5, samples=100, 
    mark=none, ultra thick, blue]{\FunctionF(x)};
\node [right, blue] at (axis cs: 0.5,20.5) {$f_2(x)$};
\end{axis}
\end{tikzpicture}}
\subfloat[$\nabla f_2(x)$ e $\nabla^2 f_2(x)$]
{\begin{tikzpicture}[scale=0.8]
\begin{axis}[
        axis y line=center,
        axis x line=middle, 
        axis on top=true,
        xmin=-1,
        xmax=1,
        ymin=-1,
        ymax=2,
    ]
    \addplot [domain=-2:2.5, samples=100, 
    mark=none, ultra thick, orange]{\FunctionFd(x)};
    \addplot [domain=-2:2.5, samples=100, 
    mark=none, ultra thick, red]{\FunctionFdd(x)};
\node [right, orange] at (axis cs: 0.1,1.5) {$\nabla f_2(x)$};
\node [right, red] at (axis cs: 0.1,1.0) {$\nabla^2 f_2(x)$};
\end{axis}
\end{tikzpicture}}
\caption{$f_2 (x) = -x_1^4 + x_1^3 +20$.}
\label{fig:2f2}
\end{figure}

A hessiana de $f_2(x)$ é dada por:
\begin{equation}
\nabla^2 f_2(x) = \left[
\begin{array}{c}
-12x_1^2 + 6x_1
\end{array}
\right]
\end{equation}

Aplicada em $x_1 = 0$ em $\nabla f_2(x)$ temos:
\begin{equation}
\nabla^2 f_2(0) = \left[
\begin{array}{c}
0
\end{array}
\right]
\end{equation}
onde não podemos concluir se é um ponto de máximo ou mínimo, pois é uma matriz
indefinida, o que leva a creer que seja um ponto de inflexão. Isto pode ser
observando na \autoref{fig:2f2}-(a) onde é apresentado o comportamento da função
$f_2(x)$.

Aplicada em $x_1 = \cfrac{3}{4}$ em $\nabla f_2(x)$ temos:
\begin{equation}
\nabla^2 f_2 \left(\frac{3}{4}\right) = \left[
\begin{array}{c}
-2.25
\end{array}
\right]
\end{equation}
onde podemos concluir diretamente, pelo autovalor único $(\lambda_1 = -2.25)$,
que se trata de um ponto de máximo.

\subsection*{\autoref{eq:2f3}}
\begin{equation}
f_3 (x) = x_1^2 + 2x_1 + 3x_2^2 + 6x_2 + 2 \tag{\ref{eq:2f3}} 
\end{equation}
Para este último caso, temos $\nabla f_3(x)$ dado por:
\begin{equation}
\nabla f_3(x) = \left[
\begin{array}{c}
2x_1 + 2\\
6x_2 + 6
\end{array}
\right]
\end{equation}

Para a condição necessária de máximo ou minimos devemos ter $\nabla f_3(x) =
0$, isto ocorre apenas em $x = [-1, -1]^{\rm{T}}$. Partindo da hessiana de
$f_3(x)$ que é igual à:
\begin{equation}
\nabla^2 f_3(x) = \left[
\begin{array}{cc}
2 & 0\\
0& 6
\end{array}
\right]
\end{equation}
e aplicando em $x = [-1, -1]^{\rm{T}}$ temos os uma matriz positiva definida,
com os seguintes autovalores:
\begin{itemize}
  \item $\lambda_1 = 6$
  \item $\lambda_2 = 2$
\end{itemize}
portanto, um ponto de mínimo, como pode ser visto na \autoref{fig:2f3}.

\begin{figure} [h]
\centering
\begin{tikzpicture}
    \begin{axis}[
        , xlabel = $x_1$
        , ylabel = $x_2$
        , domain = -20:20
        , y domain = -20:20
        , enlargelimits
        , view = {0}{90}
        ]

       \addplot3[samples=100, contour gnuplot={levels={200, 100, 25, 3}},
       thick] {x^2 + 2*x + 3*y^2 + 6*y + 2};
    \end{axis}
\end{tikzpicture}
\caption{$f_3 (x) = x_1^2 + 2x_1 + 3x_2^2 + 6x_2 + 2$}
\label{fig:2f3}
\end{figure}

