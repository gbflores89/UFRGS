\boxabstract{
Neste trabalho três diferentes métodos de otimização foram utilizados, DiRect,
Algoritmo Genético e PSO, para a minimização do erro experimental a fim de
ajustar o modelo F-SAC+Disp. Pode-se concluir que nenhum dos diferentes métodos
obteve um resultado satisfatório, levando a conclusão de que o problema
encontra-se no modelo utilizado para representar os dados experimentais.}

\section {Introdução}
O crescimento contínuo da demanda de energia também gera um crescimento no
consumo de combustíveis fósseis. Entretanto, sabemos que este é um recurso
finito, fazendo com que diversos pesquisadores busquem diferentes formas de
diversificar a matriz energética. Dentre as soluções procuradas, deseja-se que
seja ambientalmente correta, ou seja:
\begin{itemize}
  \item Renovável;
  \item Baixo impacto abiental;
  \item Baixo custo.
\end{itemize}

Uma das alternativas bastante estudadas é o bio-etanol, um combustível líquido
e que pode ser obtido de a partir de diversas matérias primas em diferentes
processos. Entre os processos existentes para a produção de etanol, o mais
utilizado é via fermentação, seja de cana de açúcar, beterraba ou milho. Porem
este processo envolve grande quantidade de água, pois os micro-organismos
responsáveis pela transformação da glicose em etanol não são tão resistentes
quanto se desejaria.

Motivado por este problema energético, temos que, o conhecimento do
comportamento do equilíbrio liquido-vapor do sistema etanol água é de suma
importância para a indústria alcooleira. Um dos principais motivos para esta
preocupação é o uso na gasolina. O álcool incorporado na gasolina deve ser do
tipo \emph{anidro} (sem água), porém, sabemos que o sistema etanol água forma um
azeótropo positivo com relação à pressão para sistemas isotérmicos em
temperaturas moderadas (negativo com relação à temperatura em situações
isobáricas para pressão moderada). Este azeótropo pode ser melhor observado na
\autoref{fig:vle1}.
\begin{figure}[H]
\centering
{\includegraphics[width=0.45\textwidth]
{trabFinal/EtOH1.pdf}}
{\includegraphics[width=0.45\textwidth]
{trabFinal/EtOH2.pdf}}
\caption{Comportamento do equilíbrio líquido vapor da mistura etanol (1) água
(2) na temperatura de $323.15$~K, onde é possível observar o azeótropo. Dados
experimentais de \citeonline{Kurihara1995}.}
\label{fig:vle1}
\end{figure}

O azeótropo formado por esta mistura impossibilita a separação do etanol puro
em uma coluna de destilação simples. \citeonline{Haelssig2008} estudou a
obtenção do etanol anidro obtido pelo processo de fermentação com diversas
configurações de colunas e em diferentes pressões de operação buscando o ótimo
econômico. Segundo seu trabalho, o melhor economicamente e mais factível foi a
configuração de duas colunas operando em série com pressões distintas. O
trabalho de \citeonline{Haelssig2008} corroborou com a os resultados obtidos
por \citeonline{Larsson1996}.

Para que seja possível obter o comportamento confiável do equilíbrio
líquido-vapor algum tipo de sistema (binário ou multicomponente) para o uso em
simulações nas etapas de projeto e/ou otimização de processos de separação, como
por exemplo a destilação, são necessários dados de equilíbrio confiáveis e um
modelo de coeficiente de atividade da fase líquida (modelo de $\gamma_i$ ou
também conhecido como modelo de $g^{\rm{E}}$) robusto o suficiente para o
sistema em questão.

Uma grande quantidade de dados de equilíbrio líquido-vapor (VLE, Vapor-Liquid
Equilibrium) para o sistema etanol/água estão disponíveis na literatura. Assim
como diversos modelos de $g^{\rm{E}}$ e modelos de outras propriedades
termodinâmicas para este mesmo sistema. Como descrito por
\citeonline{Haelssig2008} os modelos disponíveis como Wilson e UNIQUAC ora
falham na predição do azeótropo ora são incapazes de prover informações
energéticas da mistura, como entalpia de mistura. No seu trabalho,
\citeonline{Haelssig2008} propõe como um dos objetivos de seu trabalho o
desenvolvimento de uma nova dependência com a temperatura para modelos de
$g^{\rm{E}}$ (UNIQUAC, Wilson e NRTL) comuns em simuladores de processos em que
se utilizam interações binárias, utilizando dados de VLE, pontos de azeótropo e
entalpia de excesso ($h^{\rm{E}}$).

O objetivo deste trabalho é a reprodução do trabalho de
\citeonline{Haelssig2008}, porém verificando a capacidade do modelo F-SAC+Disp
\citeonline{Flores2016} com os mesmos tipos de dados experimentais (VLE e
$h^{\rm{E}}$) utilizando diferentes métodos de otimização global e comparando
as diferentes condições de cada um.

\section {Modelo F-SAC+Disp}
O modelo F-SAC+Disp \cite{Flores2016} é um aprimoramento do modelo F-SAC
anterior, que vem sendo desenvolvido nos últimos anos. \cite{Soares2013a,
Soares2013b, Possani2013}.

Nos modelos do tipo F-SAC, assim como nas variantes do modelo UNIFAC
(\emph{UNIversal quasichemical Functional group Activity Coefficient}) e
modelos baseados no COSMO-RS (\emph{COnductor-like Screening Model for
Realistic Solvation}), o coeficiente de atividade da fase líquida é calculado
como uma função da temperatura e composição da mesma fase, como uma soma das
contribuições residual e combinatorial:
\begin{equation}
\ln{\gamma_i} = \ln{\gamma_i^{\rm res}} + \ln{\gamma_i^{\rm comb}}
\end{equation}

A contribuição combinatorial $(\ln{\gamma^{\rm{comb}}})$ geralmente leva em
conta a diferenças de forma e tamanho entre as moléculas envolvidas no sistema,
no modelo F-SAC+Disp, é calculada da seguinte maneira:
\begin{subequations}
\begin{equation}
\ln \gamma^{\rm{comb}}_{i} = 1 - V_i ' + \ln V_i '
\end{equation}
\begin{equation}
V_i ' = \frac{r_i^p}{\sum_j{x_j r_j^{\left({}^3/_4
\right)}}}
\end{equation}
\begin{equation}
r_i = \sum_k{\nu_k^{(i)}R_k}
\end{equation}
\end{subequations} 
onde $V_i'$ é a fração volumétrica da molécula $i$;
$r_i$ o volume total da molécula $i$; 
$\nu_k^{(i)}$ é o número de subgrupos do tipo $k$ na molécula $i$;
$R_k$ é volume do subgrupo $k$;

A contribuição residual $(\ln{\gamma^{\rm{res}}})$ considera as diferenças
energéticas entre as moléculas. O modelo F-SAC+Disp faz uso de termodinâmica
estatística para o cálculo desta parcela, computando as forças de atração e/ou
repulsão por meio de um perfil-$\sigma$ discretizado como segue:
\begin{equation}
\begin{aligned}
\Delta W \left (T, m, n \right ) = \theta \left (T, m, n \right
)\frac{\alpha '
\left (\sigma_m +\sigma_n\right )^2}{2}\\
 -& \frac{E^{\rm{HB}}\left (T, m, n \right )}{2} - \frac{\delta \left(T, m, n
 \right )}{2}
\end{aligned}
\end{equation}
Mais detalhes sobre os modelo do tipo F-SAC podem ser encontrados nos trabalhos
de \citeonline{Soares2013a,Soares2013b,Possani2013,Flores2016}.

\section {Métodos de otimização global}
Para a mistura de etanol/água no modelo F-SAC+Disp, temos uma série de
diferentes parâmetros para serem ajustados:
\begin{itemize}
  \item [$Q_k^+$] Área superficial positiva do subgrupo $k$;
  \item [$Q_k^-$]  Área superficial negativa do subgrupo $k$;
  \item [$\sigma_k^+$]  Carga presente na área superficial positiva do subgrupo
  $k$;
  \item [$Q_k$]  Área superficial total do subgrupo $k$;
  \item [$\delta_k^0$] Dispersão do grupo $k$ na temperatura de referencia de
  $298.15$~K;
  \item [$\delta_k^T$] Dependência da temperatura com relação à dispersão do
  grupo $k$;
  \item [$E^{\rm{HB}}$] Interação binária da ligação de hidrogênio;
  \item [$E^{\rm{HB}}_T$] Dependência da temperatura interação binária da
  ligação de hidrogênio;
\end{itemize}

Neste trabalho, os grupos e subgrupos serão tratados como iguais. O motivo
desta diferenciação na nomenclatura é devido ao fato de que a tabela de
parâmetros é referente apenas à mistura de etanol/água. Para a representação
desta mistura são necessários 3 grupos, os quais contemplam apenas um subgrupo
de mesmo nome, conforme representado na \autoref{tab:groups}. 

\begin{table}[htb] 
\renewcommand{\arraystretch}{1.3}
\caption{Representação das moléculas utilizando os segmentos 
estudados neste trabalho.}
\label{tab:groups}
\footnotesize
\begin{center}
\begin{threeparttable}
\begin{tabular}{llll}
\toprule
Componente & Fórmula & \multicolumn{2}{l}{Grupos}\\
\midrule
{Etanol} 	& \ce{C2H6O}& {$1\times$\ce{CH3}} & {$1\times$\ce{CH2OH}\tnote{(a)}}\\
{Água}		& \ce{H2O}& {$1\times$\ce{H2O}\tnote{(a)}}\\ 
\bottomrule
\end{tabular}
\begin{tablenotes}
 \item[(a)]{\scriptsize {Grupos que formam ligações de hidrogênio.}}
\end{tablenotes}
\end{threeparttable}
\end{center}
\end{table}

Partindo do princípio que os parâmetros $Q_k^+$, $Q_k^-$ e $\sigma_k^+$ são
referentes aos grupos; $Q_k$, $\delta_k^0$ e $\delta_k^T$ são referentes aos
subgrupos; $E^{\rm{HB}}$ e $E^{\rm{HB}_T}$ referentes à interação binária entre
os grupos que formam ligações de hidrogênio, em conjunto com a
\autoref{tab:groups} em que é demonstrado o conjunto de grupos e subgrupos
utilizados para a representação de cada molécula, temos um total de $xx$
parâmetros.

Como visto, a quantidade de parâmetros existentes no problema é grande,
principalmente quando se trata de um modelo altamente não linear, como o modelo
F-SAC+Disp. Para este estudo, foram pesquisados três diferentes métodos de
otimização para minimizar a função objetivo.

\subsection {Algoritmos Determinísticos}
Algoritmos Determinísticos são denominados matematicamente quando, uma mesma
entrada (valores ou iniciais ou de fronteiras) geram uma mesma saída. Estes
algoritmos não possuem aleatoriedade envolvida, ou seja, caso executado $5$ ou
$10$ vezes, apresentarão resultados idênticos.

\subsubsection {Algotítmo DiRect}
O algoritmo Direct trata-se de um método de busca global, onde são dados os
parâmetros de fronteira, partindo da dimensão do problema $k$, é formado um
poliedro, o qual é repartido em $n$ vezes e o valore da função objetivo é
calculados no centro do mesmo. Uma vez obtido o menor valor entre estes pontos,
o poliedro que obteve o melhor valor para o objetivo desejado é repartido em
novos poliedros de $k$ dimensoes, para os passos seguintes, em que são
calculados novamente o valor da função objetivo, e sistematicamente segue. Por
fim devido ao número de seções efetuadas um valor mínimo é obtido. Este
raciocínio é melhor exemplificado na \autoref{fig:direct} utilizando uma função
objetivo de dois parâmetros genérica, onde quanto mais escuro o poliedro melhor
o valor da função objetivo.

\begin{figure}[H]
\centering
{\includegraphics[width=0.8\textwidth]
{trabFinal/direct.pdf}}
\caption{Representação esquemática de um problema binário resolvido via
algoritmo DiRect, onde quanto mais escuro o poliedro formado, melhor o valor da
função objetivo.}
\label{fig:direct}
\end{figure}

O Algoritmo DiRect utilizado neste trabalho foi implementado na linguagem
\code{JAVA} dentro do laboratório implementando a \emph{Interface}
\code{Objective Function}, presente em \citeonline{ Apache2004}. 

\subsection {Algoritmos estocásticos }
A classe de algoritmos estocásticos são geralmente métodos de otimização para a
busca do mínimo global do sistema estudado. O grande diferencial destes métodos
é a adoção da aleatoriedade. Esta aleatoriedade conferida ao método dá a
possibilidade de explorar possíveis soluções que os algoritmos determinísticos
como Newton e Nelder Mead não proporcionam e geralmente com um número de
iterações muito menor que métodos de busca global, como DiRect necessitam.

\subsubsection {Algorítmo Genético (AG)}
O Algoritmo Genético parte da teoria de Charles Darwin, a qual fala que os mais
aptos têm melhor melhores condições de se desenvolver, em contrapartida, os
menos aptos tendem à desaparecer da espécie em questão, também conhecida como
seleção natural. Este método tem por objetivo descartar os piores indivíduos
(maior valor da função objetivo caso a direção seja minimizar a mesma, e
vice-e-versa) e evoluir os melhores. Entretanto, este método é muito dependente
da inicialização, uma vez que se a primeira geração de indivíduos é muito ruim,
a probabilidade de que as próximas evoluam para o ótimo global não é tão grande
quanto o esperado. Assim, são necessárias várias inicializações do algoritmo,
selecionando a melhor das melhores.

Este algoritmo foi implementado em \code{JAVA} por \citeonline{Jgap} e
obtido através do pacote computacional \code{jgap}, disponível na
internet para consulta.

\subsubsection {Particle Swarm Optimization (PSO)}
O método PSO (\emph{Particle Swarm Optimization} -- Optimização por Enxame de
Partículas) foi implementado na linguagem \code{JAVA} no laboratório para fins
deste trabalho. Apresentado por \citeonline{ Kennedy1995}, este método tem duas
principais vertentes, a primeira delas é a vida artificial, representando a
revoada de pássaros e cardumes de peixes pela forma do comportamento social
(efeito de madada). A segunda, é inspirada em algoritmos genéticos e programação
evolucionária. Infelizmente, assim como no AG, em que a inicialização da rotina
de otimização é aleatória, este método depende também muito de seu início, uma
vez que a melhor partícula da primeira iteração coordena o movimento das demais,
fazendo com que sejam necessárias diversas inicializações.


\section{Descrição do problema}
Como já relatado por
\citeonline{Soares2013a,Soares2013b,Possani2013} e \citeonline{Flores2016}, os
problemas envolvendo os modelos do tipos F-SAC tratam-se de sistemas de equações
altamente não lineares. Devidos à desafios matemáticos, métodos de busca local,
como Newton, tem gerados problemas na otimização da função objetivo evido ao
seu \emph{mau comportamento} e diversos mínimos locais \cite{Possani2013}. Para
transpor estas dificuldades, propõe-se novas técnicas, dentre elas, trabalhos em
que se utilizam de métodos de otimização global.

\subsection{Função objetivo}
A Função Objetivo ($OF$ -- \emph{Objective Function}) deste trabalho teve como
base duas propriedades termodinâmicas relevantes ao mesmo, a pressão, $P$, e a
entalpia de excesso, $h^{\rm{E}}$. Estas propriedades foram condensadas em uma
mesma $OF$, como segue:
\begin{equation}
OF = AARD_{VLE} + AARD_{ h^{\rm{E}}}
\end{equation}
onde $AARD$ (\emph{Average Absolute Relative Deviation}) é o Desvio
Médio Relativo Absoluto de cada propriedade, como segue:
\begin{subequations}
\begin{equation}
AARD_{ VLE} = \frac{1}{NP} \sum_i^{NP} \frac{\left| 
P_{i, \rm{exp}} - P_{i, \rm{calc}} \right|}{ P_{i, \rm{exp}}}
\end{equation}
\begin{equation}
AARD_{ h^{\rm{E}}} = \frac{1}{NP} \sum_i^{NP} \frac{\left| 
h^{\rm{E}}_{i, \rm{exp}} - h^{\rm{E}}_{i, \rm{calc}} \right|}{ h^{\rm{E}}_{i,
\rm{exp}}}
\end{equation}
\end{subequations}
onde $NP$ é o número de pontos experimentais$P$ é calculado utilizando a Lei de
Raoult Modificada e $h^{\rm{E}}$ é calculado utilizando rotinas internas do
modelo F-SAC+Disp.

Neste trabalho não foi utilizado uma função objetiva da forma quadrática.
Apesar de o valor absoluto do erro não ser uma função estritamente convexa,
utiliza-se a mesma devido que em pequenos valores da $OF$ os mesmos tem um
valor ainda mais reduzidos, como segue na demonstração da \autoref{tab:demo}.
Aqui é possível observar, em valores genéricos, que a ordem de grandeza se
altera muito caso fosse utilizada uma $OF$ quadrática, fazendo com que quando
são combinados tipos de dados experimentais diferentes, $\ln\gamma_i$, $P$ e $
h^{\rm{E}}$impossibilitem o uso da mesma.

\begin{table}[H] 
\renewcommand{\arraystretch}{1.3}
\caption{Representação do comportamento da função objetivo utilizando
diferentes formulações.}
\label{tab:demo}
\footnotesize
\begin{center}
\begin{tabular}{
S[table-format=4.2]
S[table-format=2.3]
S[table-format=4.6]}
\toprule
\multirow{2}{*}{$Erro$} & \multicolumn{2}{c}{Função objetivo}\\
\cmidrule(lr{.5em}){2-3}
 & {$\left| Erro \right|$} & {$\left( Erro \right)^2$}\\
\midrule
10		&	10		&	100	\\
1			&	1		&	1	\\
0.1		&	0.1		&	0.01	\\
0.001		&	0.001	&	0.000001	\\
-0.001	&	0.001	&	0.000001	\\
-0.1		&	0.1		&	0.01	\\
-1		&	1		&	1	\\
-10		&	10		&	100	\\
\bottomrule
\end{tabular}
\end{center}
\end{table} 

\section{Resultados}
Os resultados obtidos neste trabalho serão apresentados a seguir, diferenciando
cada método utilizado. Para a análise destes resultados foram utilizados os
resultados da mistura etanol/água na temperatura de $323$~K tanto de VLE quanto
$h^{\rm{E}}$.

\subsection{Resultados do Algoritmos DiRect}
Para o algoritmo DiRect foram utilizados três diferentes conjuntos de
parametrização, demonstrados na \autoref{tab:resDiRect}, em conjunto com o
resultado obtido pela função objetivo. Aqui, os valores $\varepsilon$ e MinSize
são referentes a quantas vezes a $FO$ será avaliada em um mesmo poliedro e qual
o critério no qual o poliedro não deverá ser mais dividido.

\begin{table}[H]
\renewcommand{\arraystretch}{1.3}
\sisetup{table-format=1.4,round-mode=places,round-precision=4}
\caption{Conjunto de problemas executados neste trabalho utilizando o algoritmo
genético.}
\label{tab:resDiRect}
\footnotesize
\begin{center}
\begin{tabular}{S[table-format=1.0]SSS}
\toprule
{Conjunto} &{$\varepsilon$}	 &{MinSize} &{$FO$}	\\
\midrule
1&	0.001	&	0.001	&0.\\
2&	0.001	&	0.001	&0.\\
3&	0.001	&	0,001	&0.\\
\bottomrule
\end{tabular}
\end{center}
\end{table} 




\subsection{Resultados do Algoritmos Genético}

\begin{table}[H] 
\renewcommand{\arraystretch}{1.3}
\sisetup{table-format=3.0,round-mode=places,round-precision=0}
\caption{Conjunto de problemas executados neste trabalho utilizando o algoritmo
genético.}
\label{tab:resAG}
\footnotesize
\begin{center}
\begin{tabular}{S[table-format=1.0]SS
S[table-format=0.4,round-mode=places,round-precision=4]}
\toprule
{Conjunto} &{População inicial}	 &{Gerações} &{$FO$}	\\
\midrule
1&	50	&	5	&0.\\
2&	100	&	5	&0.\\
3&	100	&	10	&0.\\
\bottomrule
\end{tabular}
\end{center}
\end{table} 


\subsection{Resultados do Algoritmos PSO}
































